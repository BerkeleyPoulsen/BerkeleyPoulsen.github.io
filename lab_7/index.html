<!DOCTYPE html>
<html lang="en">

<head>
  <title>Test AJAX page</title>
  <link rel="stylesheet" type="text/css" href="./lab_styles.css">
</head>

<body>
  <div class="container">
    <div class="wrapper">
      <div class="header">UMD Bus Routes</div>
      <button class="button" onclick="loadData()">Load Some JSON</button>
      <div class="content">
        <ul class = "list"></ul>
      </div>
      <div class="footer"></div>
    </div>
  </div>
  <script>
function listDOM(arr){
  var i = 0;
  document.querySelector(".list").innerHTML = '';
  for (i = 0; i < arr.length; i++){
    var index = document.createElement('li');
    index.appendChild(document.createTextNode(arr[i]));
    document.querySelector(".list").appendChild(index);
  };
};

function loadData(){
  fetch("https://api.umd.io/v0/bus/routes")
  .then(res => res.json())
  .then(res => {
  // you can now work in this area
  var len = res.length;
  var i;
  var arr = [];
  for (i = 0; i < len; i++){
    //res = res[i]["route_id"];
    id_pop = res[i]["route_id"];
    title_pop = res[i]["title"];
    arr.push(id_pop);
    arr.push(title_pop);};
    console.log(arr);
    return arr;})
    .then(array => {listDOM(array);
      return array})
    .then(array => {var bus_name = array.find(element => element == "132 The Varsity");
      var name = "UMD Bus Route " + bus_name;
      console.log(name);
      return name})
    .then(data => {document.querySelector(".header").innerText = data;
      console.log(data);
      return data});
};
  </script>
</body>
</html>